SELECT p.category, SUM(p.price * s.quantity) AS total_revenue,st.region
FROM stores st JOIN sales s ON st.store_id = s.store_id JOIN products p ON s.product_id = p.product_id
GROUP BY p.category,st.region
ORDER BY total_revenue